<!-- =========================
     ‚úÖ Regles.html (Genially 1980x1020)
     - Page NOIRE plein √©cran + style ‚Äújeu pro‚Äù
     - Progression UI (barre XP en haut)
     - Boutons Pr√©c√©dent/Suivant √† DROITE
     - Son UNIQUEMENT sur approbation (arriv√©e √† la fin)
     - "Commencer la mission" en bas : d√©sactiv√© jusqu‚Äôau dernier step
     - Au clic : √©cran noir + progress bar -> lance assets/intro2.mp4 (16:9)
     - Fin vid√©o : √©cran noir "Pr√™t(e)..." + bouton "Commencer l'aventure" (sans lien)
     - (Bouton recommencer supprim√©)
     ‚úÖ FIX VIDEO: on affiche le conteneur 16:9 (#videoStage) (sinon son OK mais image invisible)
========================= -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Urgences ‚Äì R√®gles du jeu</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

<style>
  html, body { background:#000; margin:0; color:#fff; }

  /* ‚úÖ Genially: 1980x1020 + scale auto */
  .genially-stage{ width:100vw; height:100vh; display:flex; align-items:center; justify-content:center; overflow:hidden; background:#000; }
  .genially-page{ width:1980px; height:1020px; position:relative; transform-origin:center; background:#000; }

  .fx-overlay{
    position:absolute; inset:0; pointer-events:none;
    background:
      radial-gradient(1100px 520px at 50% 18%, rgba(140,200,255,.10), transparent 58%),
      radial-gradient(900px 520px at 22% 82%, rgba(255,165,0,.08), transparent 62%),
      radial-gradient(900px 520px at 78% 82%, rgba(255,80,120,.06), transparent 62%),
      radial-gradient(1200px 900px at 50% 55%, transparent 58%, rgba(0,0,0,.70) 100%),
      linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.85));
    filter: blur(.2px);
  }

  .page-wrap{
    position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
    padding: 42px 52px;
  }
  .container{ max-width: 1500px; }

  /* Title */
  .gameTitleWrap{ text-align:center; margin-bottom:16px; position:relative; isolation:isolate; }
  .titlePill{
    display:inline-flex; align-items:center; justify-content:center;
    padding: 10px 18px; border-radius:999px;
    font-size:13px; letter-spacing:.22em; text-transform:uppercase;
    color:rgba(255,255,255,.92);
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.14);
    backdrop-filter: blur(10px);
    box-shadow:0 22px 60px rgba(0,0,0,.55);
    margin-bottom:12px;
  }
  .gameTitle{
    font-family:'Anton',sans-serif; text-transform:uppercase; letter-spacing:.06em;
    font-size: 90px; line-height:.9; margin:0;
    background: linear-gradient(180deg,#d7e9ff 0%,#86bfff 40%,#cfe3ff 100%);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 18px 70px rgba(0,0,0,.85),0 0 45px rgba(120,190,255,.20);
    filter: drop-shadow(0 18px 55px rgba(0,0,0,.65));
  }
  .gameSubtitle{
    font-family:'Anton',sans-serif; text-transform:uppercase; letter-spacing:.05em;
    font-size: 82px; line-height:.92; margin:8px 0 0;
    color:rgba(255,255,255,.98);
    text-shadow:0 26px 90px rgba(0,0,0,.90),0 0 28px rgba(255,255,255,.08);
  }

  /* UI TOP (Bonjour + XP) */
  .uiTop{
    width:min(1500px,100%);
    margin: 0 auto 14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    flex-wrap:wrap;
  }
  .hello{
    margin:0;
    font-weight:900;
    font-size: 26px;
    text-shadow: 0 14px 40px rgba(0,0,0,.75);
  }
  .hello .name{ color: rgba(255,190,110,1); text-shadow:0 0 14px rgba(255,165,0,.35); }

  .xpWrap{
    flex: 1 1 520px;
    max-width: 720px;
    min-width: 420px;
    background: rgba(255,255,255,.05);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: 18px;
    padding: 10px 12px;
    box-shadow: 0 18px 55px rgba(0,0,0,.55);
    position: relative;
    overflow:hidden;
  }
  .xpWrap::before{
    content:"";
    position:absolute; inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.18; pointer-events:none;
  }
  .xpTop{
    display:flex; align-items:center; justify-content:space-between; gap:10px;
    position:relative; z-index:1;
  }
  .xpLabel{
    margin:0;
    font-size: 12px;
    letter-spacing: .20em;
    text-transform: uppercase;
    color: rgba(255,255,255,.78);
    font-weight: 900;
    display:flex; align-items:center; gap:10px;
  }
  .xpChip{
    display:inline-flex; align-items:center; gap:8px;
    padding: 7px 11px; border-radius:999px;
    border:1px solid rgba(255,255,255,.14);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.90);
    font-size: 12px;
    font-weight: 900;
    letter-spacing:.12em;
    text-transform: uppercase;
    white-space: nowrap;
  }
  .xpDot{
    width:10px;height:10px;border-radius:999px;
    border:1px solid rgba(140,200,255,.55);
    background: rgba(140,200,255,.18);
    box-shadow:0 0 14px rgba(140,200,255,.25);
  }
  .xpBar{
    height: 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.10);
    border: 1px solid rgba(255,255,255,.12);
    overflow:hidden;
    margin-top: 9px;
    position:relative; z-index:1;
  }
  .xpFill{
    height:100%;
    width: 0%;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(140,200,255,.95), rgba(255,165,0,.85));
    box-shadow: 0 10px 30px rgba(0,0,0,.30);
    transition: width .35s ease;
  }
  .xpHint{
    margin: 8px 0 0;
    font-size: 13px;
    color: rgba(255,255,255,.70);
    position:relative; z-index:1;
  }

  /* Main glass */
  .glass{
    width: min(1500px, 100%);
    background: rgba(255,255,255,.04);
    border: 1px solid rgba(255,255,255,.12);
    backdrop-filter: blur(12px);
    border-radius: 26px;
    box-shadow: 0 22px 90px rgba(0,0,0,.65);
    overflow: hidden;
  }
  .body{ padding: 18px 20px 18px; }

  .rulesGrid{
    display:grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 16px;
    align-items: stretch;
  }

  .panel{
    background: rgba(0,0,0,.35);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: 22px;
    padding: 18px 18px 16px;
    box-shadow: 0 18px 70px rgba(0,0,0,.45);
    position: relative;
    overflow:hidden;
    transform: translateY(8px);
    opacity: 0;
    animation: panelIn .45s ease forwards;
  }
  @keyframes panelIn{ to{ transform: translateY(0); opacity:1; } }
  .panel::before{
    content:""; position:absolute; inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.16; pointer-events:none;
  }

  .panelTitle{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin:0 0 10px; }
  .panelTitle h3{ margin:0; font-weight:900; letter-spacing:.12em; text-transform:uppercase; font-size:18px; color:rgba(255,255,255,.95); }
  .tag{
    padding:7px 10px; border-radius:999px;
    border:1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.22);
    font-size:12px; font-weight:900; letter-spacing:.12em; text-transform:uppercase; color:rgba(255,255,255,.84);
    white-space: nowrap;
  }

  .ruleText{ margin:0 0 12px; color:rgba(255,255,255,.88); font-size:16px; line-height:1.55; }
  .bullets{ margin:0; padding-left:18px; color:rgba(255,255,255,.78); font-size:15px; line-height:1.55; }
  .bullets li{ margin:6px 0; }

  /* Visual */
  .visual{ display:flex; flex-direction:column; justify-content:space-between; gap:14px; height:100%; }
  .bigStat{
    position:relative; border-radius:24px; padding:18px 18px 16px;
    background: linear-gradient(180deg, rgba(0,0,0,.30), rgba(0,0,0,.20));
    border: 1px solid rgba(255,255,255,.14);
    box-shadow: 0 22px 80px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.05);
    overflow:hidden;
  }
  .bigStat::before{
    content:""; position:absolute; inset:-2px;
    background:
      radial-gradient(900px 320px at 22% 12%, rgba(140,200,255,.18), transparent 55%),
      radial-gradient(900px 320px at 78% 20%, rgba(255,165,0,.14), transparent 60%),
      linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.55; pointer-events:none;
  }
  .bigStat::after{
    content:""; position:absolute; top:-40%; left:-10%;
    width:70%; height:220%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
    transform: rotate(18deg);
    opacity:.22; pointer-events:none;
    animation: shimmer 4.8s ease-in-out infinite;
  }
  @keyframes shimmer{
    0%{ transform: translateX(-18%) rotate(18deg); opacity:.14; }
    50%{ transform: translateX(22%) rotate(18deg); opacity:.26; }
    100%{ transform: translateX(-18%) rotate(18deg); opacity:.14; }
  }

  .statTop{ display:flex; align-items:center; justify-content:space-between; gap:10px; position:relative; z-index:1; }
  .statLabel{ font-size:12px; letter-spacing:.20em; text-transform:uppercase; color:rgba(255,255,255,.72); font-weight:900; margin:0; }
  .chip{
    display:inline-flex; align-items:center; gap:8px;
    padding:7px 11px; border-radius:999px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.90);
    font-size:12px; font-weight:900; letter-spacing:.12em; text-transform:uppercase; white-space:nowrap;
  }
  .chip .dot{
    width:10px; height:10px; border-radius:999px;
    border:1px solid rgba(140,200,255,.55);
    background: rgba(140,200,255,.18);
    box-shadow:0 0 14px rgba(140,200,255,.25);
  }
  .statValue{
    font-family:'Anton',sans-serif;
    font-size:74px; letter-spacing:.06em; margin:10px 0 6px; line-height:1;
    background: linear-gradient(180deg,#ffd9a0 0%,#ffb05a 55%,#ff7832 100%);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 18px 60px rgba(0,0,0,.65);
    filter: drop-shadow(0 12px 35px rgba(0,0,0,.45));
    position:relative; z-index:1;
  }
  .statMeter{
    height:10px; border-radius:999px;
    background: rgba(255,255,255,.10);
    border:1px solid rgba(255,255,255,.12);
    overflow:hidden;
    margin:6px 0 12px;
    position:relative; z-index:1;
  }
  .statMeter > span{
    display:block; height:100%; width:72%; border-radius:999px;
    background: linear-gradient(90deg, rgba(140,200,255,.95), rgba(255,165,0,.85));
  }
  .statHint{ margin:0; color:rgba(255,255,255,.82); font-size:16px; line-height:1.45; position:relative; z-index:1; }

  .miniRow{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
  .mini{
    position:relative; border-radius:20px; padding:14px 14px 13px;
    background: rgba(0,0,0,.25);
    border: 1px solid rgba(255,255,255,.12);
    box-shadow: 0 18px 55px rgba(0,0,0,.40);
    overflow:hidden;
  }
  .mini::before{
    content:""; position:absolute; inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.18; pointer-events:none;
  }
  .miniTitle{
    display:flex; align-items:center; gap:10px; margin:0 0 8px;
    font-weight:900; letter-spacing:.12em; text-transform:uppercase;
    font-size:12px; color:rgba(255,255,255,.78);
  }
  .miniIcon{
    width:34px; height:34px; border-radius:14px; display:grid; place-items:center;
    background: rgba(140,200,255,.12);
    border: 1px solid rgba(140,200,255,.22);
    box-shadow:0 10px 28px rgba(0,0,0,.22);
    flex:0 0 auto;
  }
  .miniText{ margin:0; color:rgba(255,255,255,.90); font-size:15px; line-height:1.45; }

  /* NAV -> √† droite */
  .navBar{
    margin-top: 14px;
    display:flex;
    justify-content:flex-end; /* ‚úÖ √† droite */
    align-items:center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .btnRow{ display:flex; gap:10px; align-items:center; justify-content:flex-end; }

  .btn-ghost{
    border-radius:14px;
    border:1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.92);
    padding: 12px 16px;
    font-weight: 900;
    letter-spacing:.10em;
    text-transform:uppercase;
    font-size: 12px;
    transition: transform .15s ease, filter .15s ease, border-color .15s ease;
  }
  .btn-ghost:hover{ transform: translateY(-2px); filter: brightness(1.08); border-color: rgba(255,255,255,.26); }
  .btn-ghost:disabled{ opacity:.45; cursor:not-allowed; transform:none; filter:none; }

  .btn-ember{
    border:0;
    border-radius:14px;
    padding: 12px 16px;
    font-weight:900;
    letter-spacing:.10em;
    text-transform:uppercase;
    font-size:12px;
    background: linear-gradient(180deg,#ffb05a,#ff7832);
    color:#0a0c12;
    box-shadow:0 16px 35px rgba(255,120,50,.22);
    transition: transform .15s ease, filter .15s ease;
  }
  .btn-ember:hover{ transform: translateY(-2px); filter: brightness(1.06); }
  .btn-ember:disabled{ opacity:.45; cursor:not-allowed; transform:none; filter:none; }

  .footer{
    padding: 14px 18px;
    border-top: 1px solid rgba(255,255,255,.10);
    text-align:center;
    font-size: 13px;
    color: rgba(255,255,255,.78);
  }

  /* Steps */
  .step{ display:none; }
  .step.active{ display:block; }

  /* Bottom action */
  .bottomActions{
    margin-top: 14px;
    display:flex;
    justify-content:flex-end; /* ‚úÖ bouton mission √† droite aussi */
    align-items:center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .btnStart{
    border-radius: 16px;
    padding: 14px 18px;
    font-weight: 900;
    letter-spacing:.10em;
    text-transform: uppercase;
    font-size: 12px;
    border: 1px solid rgba(140,200,255,.55);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.92);
    box-shadow: 0 18px 70px rgba(0,0,0,.55);
    transition: transform .15s ease, filter .15s ease;
    display:inline-flex; align-items:center; gap:10px;
  }
  .btnStart:hover{ transform: translateY(-2px); filter: brightness(1.10); }
  .btnStart:disabled{ opacity:.45; cursor:not-allowed; transform:none; filter:none; }

  @media (max-width: 1200px){
    .rulesGrid{ grid-template-columns: 1fr; }
    .miniRow{ grid-template-columns: 1fr 1fr; }
    .xpWrap{ min-width: 320px; }
  }
  @media (max-width: 768px){
    .gameTitle{ font-size: 70px; }
    .gameSubtitle{ font-size: 62px; }
    .miniRow{ grid-template-columns: 1fr; }
    .xpWrap{ min-width: 280px; }
  }

  /* ======================
     ‚úÖ CINEMATIC FLOW (mission)
  ====================== */
  .missionOverlay{
    position:absolute;
    inset:0;
    z-index:9999;
    background:#000;
    display:none;
  }
  .missionOverlay.on{ display:block; }

  .missionCenter{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    padding: 48px;
    text-align:center;
  }

  .missionTitle{
    font-family:'Anton',sans-serif;
    text-transform:uppercase;
    letter-spacing:.10em;
    font-size: 54px;
    margin: 0 0 14px;
    color: rgba(255,255,255,.92);
    text-shadow: 0 22px 80px rgba(0,0,0,.85);
  }

  .missionSub{
    margin:0 0 26px;
    color: rgba(255,255,255,.70);
    letter-spacing:.18em;
    text-transform: uppercase;
    font-weight: 900;
    font-size: 13px;
  }

  .loadWrap{
    width: min(820px, 92%);
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.14);
    border-radius: 18px;
    padding: 12px 12px 14px;
    box-shadow: 0 28px 120px rgba(0,0,0,.70);
    position:relative;
    overflow:hidden;
  }
  .loadWrap::before{
    content:"";
    position:absolute;inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.18;pointer-events:none;
  }
  .loadTop{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    position:relative;z-index:1;
  }
  .loadLabel{
    margin:0;
    font-size: 12px;
    letter-spacing:.22em;
    text-transform: uppercase;
    color: rgba(255,255,255,.78);
    font-weight: 900;
  }
  .loadPct{
    margin:0;
    font-size: 12px;
    letter-spacing:.22em;
    text-transform: uppercase;
    color: rgba(255,255,255,.88);
    font-weight: 900;
  }
  .loadBar{
    margin-top: 10px;
    height: 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.10);
    border: 1px solid rgba(255,255,255,.12);
    overflow:hidden;
    position:relative;z-index:1;
  }
  .loadFill{
    height:100%;
    width:0%;
    border-radius:999px;
    background: linear-gradient(90deg, rgba(140,200,255,.95), rgba(255,165,0,.85));
    transition: width .12s linear;
  }

  .introVideo{
    width: 100%;
    height: 100%;
    object-fit: cover;
    display:none; /* shown at step VIDEO */
  }

  .readyBox{
    display:none;
    width: min(980px, 92%);
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.14);
    border-radius: 24px;
    padding: 26px 22px;
    box-shadow: 0 28px 120px rgba(0,0,0,.70);
    position:relative;
    overflow:hidden;
  }
  .readyBox::before{
    content:"";
    position:absolute;inset:-2px;
    background:
      radial-gradient(900px 320px at 22% 12%, rgba(140,200,255,.16), transparent 60%),
      radial-gradient(900px 320px at 78% 20%, rgba(255,165,0,.12), transparent 62%),
      linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.55;pointer-events:none;
  }
  .readyText{
    position:relative;z-index:1;
    font-family:'Anton',sans-serif;
    text-transform:uppercase;
    letter-spacing:.10em;
    font-size: 60px;
    margin: 0 0 10px;
    background: linear-gradient(180deg,#d7e9ff 0%,#86bfff 40%,#cfe3ff 100%);
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow: 0 22px 80px rgba(0,0,0,.85);
  }
  .readySmall{
    position:relative;z-index:1;
    margin:0 0 18px;
    color: rgba(255,255,255,.75);
    letter-spacing:.18em;
    text-transform: uppercase;
    font-weight: 900;
    font-size: 12px;
  }

  .btnAdventure{
    position:relative;z-index:1;
    border-radius: 16px;
    padding: 14px 18px;
    font-weight: 900;
    letter-spacing:.10em;
    text-transform: uppercase;
    font-size: 12px;
    border: 1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.25);
    color: rgba(255,255,255,.92);
    box-shadow: 0 18px 70px rgba(0,0,0,.55);
    transition: transform .15s ease, filter .15s ease, border-color .15s ease;
    display:inline-flex;align-items:center;gap:10px;
  }
  .btnAdventure:hover{
    transform: translateY(-2px);
    filter: brightness(1.08);
    border-color: rgba(140,200,255,.45);
  }

  /* ======================
     ‚úÖ FIX VIDEO VISIBILITY (NECESSARY ONLY)
  ====================== */
  #missionOverlay{
    position: fixed;
    inset: 0;
    z-index: 999999;
  }

  .videoStage{
    position:absolute;
    inset:0;
    display:none;
    place-items:center;
    background:#000;
    padding: 40px;
    z-index: 5;
  }

  .videoFrame{
    width: min(1600px, 92%);
    aspect-ratio: 16 / 9;
    background:#000;
    border-radius: 22px;
    border: 1px solid rgba(255,255,255,.14);
    box-shadow: 0 30px 140px rgba(0,0,0,.75);
    overflow:hidden;
    position:relative;
    z-index: 6;
  }

  .introVideo{
    width:100%;
    height:100%;
    display:block;
    object-fit: contain;
    background:#000;
    position:relative;
    z-index: 7;
  }
</style>
</head>

<body>
<div class="genially-stage">
  <div class="genially-page" id="geniallyPage">
    <div class="fx-overlay"></div>

    <div class="page-wrap">
      <div class="container">

        <div class="gameTitleWrap">
          <div class="titlePill">GUIDE ‚Ä¢ R√àGLES DU JEU</div>
          <h1 class="gameTitle">URGENCES</h1>
          <div class="gameSubtitle">AGIR POUR SAUVER</div>
        </div>

        <div class="uiTop">
          <p class="hello" id="helloLine"></p>

          <div class="xpWrap">
            <div class="xpTop">
              <p class="xpLabel">üéÆ PROGRESSION</p>
              <div class="xpChip"><span class="xpDot"></span> <span id="xpText">0% ‚Ä¢ √âtape 1/5</span></div>
            </div>
            <div class="xpBar"><div class="xpFill" id="xpFill"></div></div>
            <p class="xpHint" id="xpHint">Lis les r√®gles : ‚ÄúCommencer la mission‚Äù se d√©bloque √† la fin.</p>
          </div>
        </div>

        <div class="glass">
          <div class="body">

            <!-- STEP 1 -->
            <div class="step active" data-step="1">
              <div class="rulesGrid">
                <div class="panel">
                  <div class="panelTitle">
                    <h3>1) Choix du m√©tier</h3>
                    <span class="tag">Personnalisation</span>
                  </div>
                  <p class="ruleText">
                    Tu commences par choisir un m√©tier : <b>M√©decin</b>, <b>Pompier</b> ou <b>Infirmier</b>.
                    Ensuite, le parcours et les sc√©narios s‚Äôadaptent automatiquement √† ton r√¥le.
                  </p>
                  <ul class="bullets">
                    <li>Chaque m√©tier propose des situations coh√©rentes avec ses missions.</li>
                    <li>Ton choix est m√©moris√© pour la suite du jeu.</li>
                    <li>Tu peux recommencer plus tard avec un autre m√©tier.</li>
                  </ul>
                </div>

                <div class="panel">
                  <div class="visual">
                    <div class="bigStat">
                      <div class="statTop">
                        <p class="statLabel">R√àGLE CL√â</p>
                        <div class="chip"><span class="dot"></span> ADAPTATIF</div>
                      </div>
                      <p class="statValue">3</p>
                      <div class="statMeter"><span style="width:72%"></span></div>
                      <p class="statHint">3 m√©tiers au choix ‚Äî ton parcours se personnalise automatiquement.</p>
                    </div>

                    <div class="miniRow">
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üí°</span> Conseil</p>
                        <p class="miniText">Choisis le r√¥le qui te motive : tu seras plus rapide et plus s√ªr.</p>
                      </div>
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üíæ</span> Sauvegarde</p>
                        <p class="miniText">Ton m√©tier est m√©moris√© pour les √©tapes suivantes.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- STEP 2 -->
            <div class="step" data-step="2">
              <div class="rulesGrid">
                <div class="panel">
                  <div class="panelTitle">
                    <h3>2) Choix du niveau</h3>
                    <span class="tag">Difficult√©</span>
                  </div>
                  <p class="ruleText">
                    Tu choisis ensuite un niveau : <b>D√©butant</b>, <b>Interm√©diaire</b> ou <b>Expert</b>.
                    La difficult√© (indices, rapidit√©, exigences) s‚Äôajuste √† ton choix.
                  </p>
                  <ul class="bullets">
                    <li><b>D√©butant</b> : guidage renforc√© et apprentissage progressif.</li>
                    <li><b>Interm√©diaire</b> : moins d‚Äôindices, plus d‚Äôautonomie.</li>
                    <li><b>Expert</b> : sc√©narios exigeants, temps de r√©action serr√©.</li>
                  </ul>
                </div>

                <div class="panel">
                  <div class="visual">
                    <div class="bigStat">
                      <div class="statTop">
                        <p class="statLabel">R√àGLE CL√â</p>
                        <div class="chip"><span class="dot"></span> NIVEAUX</div>
                      </div>
                      <p class="statValue">3</p>
                      <div class="statMeter"><span style="width:66%"></span></div>
                      <p class="statHint">Choisis ta difficult√© : D√©butant, Interm√©diaire ou Expert.</p>
                    </div>

                    <div class="miniRow">
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üéØ</span> Objectif</p>
                        <p class="miniText">Adapter le challenge √† ton rythme d‚Äôapprentissage.</p>
                      </div>
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">‚öôÔ∏è</span> Ajustement</p>
                        <p class="miniText">Indices, rythme et exigence changent selon le niveau.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- STEP 3 -->
            <div class="step" data-step="3">
              <div class="rulesGrid">
                <div class="panel">
                  <div class="panelTitle">
                    <h3>3) Syst√®me de points</h3>
                    <span class="tag">Score</span>
                  </div>
                  <p class="ruleText">
                    √Ä chaque r√©ponse correcte, tu gagnes <b>10 points</b>.
                    Ton score refl√®te ta progression et encourage la r√©gularit√©.
                  </p>
                  <ul class="bullets">
                    <li>Bonne r√©ponse = <b>+10</b> points.</li>
                    <li>Le score peut servir √† d√©bloquer des √©tapes (selon ton sc√©nario Genially).</li>
                    <li>Reste concentr√© : chaque choix compte.</li>
                  </ul>
                </div>

                <div class="panel">
                  <div class="visual">
                    <div class="bigStat">
                      <div class="statTop">
                        <p class="statLabel">GAIN</p>
                        <div class="chip"><span class="dot"></span> POINTS</div>
                      </div>
                      <p class="statValue">+10</p>
                      <div class="statMeter"><span style="width:80%"></span></div>
                      <p class="statHint">Chaque bonne r√©ponse ajoute 10 points √† ton score.</p>
                    </div>

                    <div class="miniRow">
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üìà</span> Progression</p>
                        <p class="miniText">Plus tu r√©ussis, plus tu avances rapidement.</p>
                      </div>
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">‚è±Ô∏è</span> Focus</p>
                        <p class="miniText">La rapidit√© et la pr√©cision font la diff√©rence.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- STEP 4 -->
            <div class="step" data-step="4">
              <div class="rulesGrid">
                <div class="panel">
                  <div class="panelTitle">
                    <h3>4) Tentatives et reprise</h3>
                    <span class="tag">Rigueur</span>
                  </div>
                  <p class="ruleText">
                    Si tu perds <b>2 tentatives</b>, tu dois reprendre les questions <b>depuis le d√©but</b>.
                    L‚Äôobjectif : renforcer la m√©morisation et la ma√Ætrise des gestes.
                  </p>
                  <ul class="bullets">
                    <li>2 erreurs = reprise du bloc de questions.</li>
                    <li>Reste attentif et relis les consignes.</li>
                    <li>Le jeu r√©compense la pers√©v√©rance.</li>
                  </ul>
                </div>

                <div class="panel">
                  <div class="visual">
                    <div class="bigStat">
                      <div class="statTop">
                        <p class="statLabel">LIMITE</p>
                        <div class="chip"><span class="dot"></span> TENTATIVES</div>
                      </div>
                      <p class="statValue">2</p>
                      <div class="statMeter"><span style="width:58%"></span></div>
                      <p class="statHint">Apr√®s 2 √©checs : retour au d√©but des questions.</p>
                    </div>

                    <div class="miniRow">
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üß†</span> M√©moire</p>
                        <p class="miniText">Recommencer aide √† consolider les bons r√©flexes.</p>
                      </div>
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üõ°Ô∏è</span> S√©curit√©</p>
                        <p class="miniText">En urgence, une erreur peut co√ªter cher : entra√Ænement obligatoire.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- STEP 5 -->
            <div class="step" data-step="5">
              <div class="rulesGrid">
                <div class="panel">
                  <div class="panelTitle">
                    <h3>5) Badges de sc√©nario</h3>
                    <span class="tag">R√©compense</span>
                  </div>
                  <p class="ruleText">
                    Chaque sc√©nario termin√© te fait gagner un <b>badge</b>.
                    C‚Äôest une r√©compense visuelle qui valide tes acquis.
                  </p>
                  <ul class="bullets">
                    <li>1 sc√©nario termin√© = <b>1 badge</b>.</li>
                    <li>Les badges montrent ta progression dans la mission.</li>
                    <li>Objectif : collectionner tous les badges !</li>
                  </ul>
                </div>

                <div class="panel">
                  <div class="visual">
                    <div class="bigStat">
                      <div class="statTop">
                        <p class="statLabel">R√âCOMPENSE</p>
                        <div class="chip"><span class="dot"></span> BADGES</div>
                      </div>
                      <p class="statValue">üèÖ</p>
                      <div class="statMeter"><span style="width:74%"></span></div>
                      <p class="statHint">Terminer un sc√©nario d√©bloque un badge de progression.</p>
                    </div>

                    <div class="miniRow">
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">‚úÖ</span> Validation</p>
                        <p class="miniText">Chaque badge confirme que tu ma√Ætrises une comp√©tence.</p>
                      </div>
                      <div class="mini">
                        <p class="miniTitle"><span class="miniIcon">üèÅ</span> Objectif</p>
                        <p class="miniText">Obtenir tous les badges = mission compl√®te.</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- NAV -> √† droite -->
            <div class="navBar">
              <div class="btnRow">
                <button class="btn-ghost" type="button" id="prevBtn">‚¨ÖÔ∏è Pr√©c√©dent</button>
                <button class="btn-ember" type="button" id="nextBtn">Suivant ‚û°Ô∏è</button>
              </div>
            </div>

            <!-- Commencer mission -> √† droite -->
            <div class="bottomActions">
              <button class="btnStart" type="button" id="startMissionBtn" disabled>üöÄ Commencer la mission</button>
            </div>

          </div>

          <div class="footer" id="helpTxt">
            Utilise ‚ÄúSuivant‚Äù pour lire les r√®gles, √©tape par √©tape.
          </div>
        </div>

        <!-- ‚úÖ Son d‚Äôapprobation seulement -->
        <audio id="sfxOk" preload="auto">
          <source src="assets/sfx/ok.mp3" type="audio/mpeg">
        </audio>

      </div>
    </div>

    <!-- ‚úÖ Overlay mission (chargement -> vid√©o -> pr√™t) -->
    <div class="missionOverlay" id="missionOverlay">
      <!-- Loading screen -->
      <div class="missionCenter" id="loadScreen">
        <h2 class="missionTitle">Chargement de la mission‚Ä¶</h2>
        <p class="missionSub">Pr√©paration de l‚Äôintroduction</p>

        <div class="loadWrap">
          <div class="loadTop">
            <p class="loadLabel">SYST√àME</p>
            <p class="loadPct" id="loadPct">0%</p>
          </div>
          <div class="loadBar">
            <div class="loadFill" id="loadFill"></div>
          </div>
        </div>
      </div>

      <!-- Video screen (‚úÖ 16:9) -->
      <div class="videoStage" id="videoStage">
        <div class="videoFrame">
          <video id="introVideo" class="introVideo" playsinline preload="auto">
            <source src="assets/intro2.mp4" type="video/mp4">
          </video>
        </div>
      </div>

      <!-- Ready screen -->
      <div class="missionCenter" id="readyScreen" style="display:none;">
        <div class="readyBox" id="readyBox" style="display:block;">
          <h2 class="readyText">Pr√™t(e)‚Ä¶</h2>
          <p class="readySmall">Respire. Observe. Agis.</p>
          <button class="btnAdventure" id="adventureBtn" type="button">‚ú® Commencer l‚Äôaventure</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  /* ‚úÖ Scale auto pour Genially (1980x1020) */
  (function scaleGeniallyPage(){
    const page = document.getElementById('geniallyPage');
    function apply(){
      const sw = window.innerWidth / 1980;
      const sh = window.innerHeight / 1020;
      const s = Math.min(sw, sh);
      page.style.transform = `scale(${s})`;
    }
    window.addEventListener('resize', apply);
    apply();
  })();

  /* ‚úÖ Bonjour "nom utilisateur" */
  const playerName =
    localStorage.getItem("player_name") ||
    localStorage.getItem("playerName") ||
    "Joueur";

  document.getElementById("helloLine").innerHTML =
    `Bonjour <span class="name">${escapeHtml(playerName)}</span>, d√©couvre les r√®gles du jeu.`;

  const steps = Array.from(document.querySelectorAll(".step"));
  const helpTxt = document.getElementById("helpTxt");
  const prevBtn = document.getElementById("prevBtn");
  const nextBtn = document.getElementById("nextBtn");

  const xpFill = document.getElementById("xpFill");
  const xpText = document.getElementById("xpText");
  const xpHint = document.getElementById("xpHint");

  const startMissionBtn = document.getElementById("startMissionBtn");
  const sfxOk = document.getElementById("sfxOk");

  // Mission overlay refs
  const missionOverlay = document.getElementById("missionOverlay");
  const loadScreen = document.getElementById("loadScreen");
  const loadFill = document.getElementById("loadFill");
  const loadPct = document.getElementById("loadPct");
  const introVideo = document.getElementById("introVideo");
  const readyScreen = document.getElementById("readyScreen");

  /* ‚úÖ FIX VIDEO VISIBILITY (NECESSARY ONLY) */
  const videoStage = document.getElementById("videoStage");

  let current = 0;

  function progressPercent(){
    if (steps.length <= 1) return 100;
    return Math.round((current / (steps.length - 1)) * 100);
  }

  function goTo(i){
    current = Math.max(0, Math.min(steps.length - 1, i));
    steps.forEach((s, idx)=> s.classList.toggle("active", idx === current));

    prevBtn.disabled = current === 0;
    nextBtn.disabled = current === steps.length - 1;

    // Progress UI
    const pct = progressPercent();
    xpFill.style.width = pct + "%";
    xpText.textContent = `${pct}% ‚Ä¢ √âtape ${current+1}/${steps.length}`;

    const hints = [
      "Choisis ton m√©tier : le parcours s‚Äôadapte √† ton r√¥le.",
      "Choisis un niveau : la difficult√© s‚Äôajuste.",
      "Chaque bonne r√©ponse = +10 points.",
      "Apr√®s 2 tentatives perdues : reprise depuis le d√©but des questions.",
      "Fin ! Tu es pr√™t(e) ‚Äî ‚ÄúCommencer la mission‚Äù est d√©verrouill√©."
    ];
    helpTxt.textContent = hints[current] || "Utilise ‚ÄúSuivant‚Äù pour continuer.";
    xpHint.textContent = (current === steps.length - 1)
      ? "‚úÖ Mission pr√™te : tu peux d√©marrer."
      : "Lis toutes les r√®gles : le bouton de mission se d√©bloque √† la fin.";

    // Unlock at end
    const atEnd = current === steps.length - 1;
    startMissionBtn.disabled = !atEnd;

    // ‚úÖ Son uniquement sur approbation (arriv√©e fin)
    if (atEnd) {
      try {
        sfxOk.currentTime = 0;
        sfxOk.play().catch(()=>{});
      } catch(e){}
    }
  }

  prevBtn.addEventListener("click", ()=>goTo(current - 1));
  nextBtn.addEventListener("click", ()=>goTo(current + 1));

  window.addEventListener("keydown", (e)=>{
    if (e.key === "ArrowLeft") goTo(current - 1);
    if (e.key === "ArrowRight") goTo(current + 1);
  });

  /* =========================
     ‚úÖ Commencer la mission :
     1) √©cran noir + loading bar
     2) lecture intro2.mp4 (16:9)
     3) fin vid√©o -> √©cran noir "Pr√™t(e)" + bouton
  ========================= */
  startMissionBtn.addEventListener("click", async ()=>{
    if (startMissionBtn.disabled) return;

    // 1) show overlay loading
    missionOverlay.classList.add("on");
    loadScreen.style.display = "flex";

    /* ‚úÖ FIX VIDEO VISIBILITY (NECESSARY ONLY) */
    videoStage.style.display = "none";
    introVideo.style.display = "none";

    readyScreen.style.display = "none";

    // Loading animation (fake but smooth + pro)
    await runLoading(1500);

    // 2) Play video
    loadScreen.style.display = "none";

    /* ‚úÖ FIX VIDEO VISIBILITY (NECESSARY ONLY) */
    videoStage.style.display = "grid";   // IMPORTANT: sinon parent cach√© -> son ok mais image invisible
    introVideo.style.display = "block";

    try { introVideo.currentTime = 0; } catch(e){}
    try {
      await introVideo.play();
    } catch(e){
      // si autoplay bloqu√©, un clic dans Genially le d√©bloque g√©n√©ralement
      // on laisse la vid√©o affich√©e, l‚Äôutilisateur peut relancer via tap/clic
    }
  });

  introVideo.addEventListener("ended", ()=>{
    // 3) Ready screen
    /* ‚úÖ FIX VIDEO VISIBILITY (NECESSARY ONLY) */
    videoStage.style.display = "none";
    introVideo.style.display = "none";

    readyScreen.style.display = "flex";
  });

  async function runLoading(durationMs){
    const start = performance.now();
    const end = start + durationMs;

    return new Promise(resolve=>{
      function tick(now){
        const t = Math.min(1, (now - start) / durationMs);
        const pct = Math.round(t * 100);
        loadFill.style.width = pct + "%";
        loadPct.textContent = pct + "%";
        if (now < end) requestAnimationFrame(tick);
        else resolve();
      }
      requestAnimationFrame(tick);
    });
  }

  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g,m=>({
      "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
    }[m]));
  }

  // Init
  goTo(0);
</script>
</body>
</html>
