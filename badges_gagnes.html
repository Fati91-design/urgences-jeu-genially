<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Urgences ‚Äî Badges</title>

<style>
:root{
  --glass: rgba(25,27,31,.72);
  --glass2: rgba(15,17,20,.55);

  --text: rgba(255,255,255,.93);
  --muted: rgba(255,255,255,.70);

  --gold: rgba(255,200,80,1);
  --red: rgba(255,70,70,1);
  --green: rgba(45,200,120,1);
  --blue: rgba(80,170,255,1);
  --ember: rgba(255,150,70,1);
  --ember2: rgba(255,120,50,1);

  --line: rgba(255,255,255,.12);
  --line2: rgba(255,255,255,.08);

  --shadow: 0 18px 70px rgba(0,0,0,.50);
  --shadow2: 0 14px 34px rgba(0,0,0,.28);

  --r18: 18px;
  --r22: 22px;
}

html,body{
  margin:0;
  background: transparent;
  overflow:hidden; /* Genially */
  color: var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* ‚úÖ Stage Genially */
.stage{
  height:100vh;
  padding: 10px;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:stretch;
  position: relative;
}

/* ‚ú® Glow ambience (style jeu) */
.stage::before,
.stage::after{
  content:"";
  position:absolute;
  inset:-30px;
  pointer-events:none;
  z-index:0;
  opacity:.9;
}
.stage::before{
  background:
    radial-gradient(760px 260px at 18% 10%, rgba(255,150,70,.18), transparent 62%),
    radial-gradient(920px 340px at 85% 22%, rgba(80,170,255,.12), transparent 62%),
    radial-gradient(860px 340px at 55% 120%, rgba(255,200,80,.10), transparent 62%);
  filter: blur(2px);
}
.stage::after{
  background:
    radial-gradient(560px 220px at 15% 80%, rgba(80,170,255,.09), transparent 62%),
    radial-gradient(680px 280px at 92% 92%, rgba(255,120,50,.10), transparent 62%);
  mix-blend-mode: screen;
}

/* ‚úÖ Un seul grand conteneur */
.bigWrap{
  width: min(1650px, 100%);
  height: 100%;
  position: relative;
  z-index: 1;

  border-radius: var(--r22);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.18));
  border: 1px solid rgba(255,200,150,.22);
  box-shadow: var(--shadow);
  backdrop-filter: blur(12px);

  overflow:hidden;
  display:grid;
  grid-template-columns: 340px 1fr;
}

/* Light sheen */
.bigWrap::after{
  content:"";
  position:absolute;
  inset:-2px;
  pointer-events:none;
  background:
    radial-gradient(900px 320px at 20% 0%, rgba(255,150,70,.16), transparent 62%),
    radial-gradient(980px 360px at 92% 120%, rgba(80,170,255,.10), transparent 62%);
  opacity:.9;
  z-index:0;
}

/* LEFT */
.left{
  position:relative;
  z-index:1;
  border-right: 1px solid rgba(255,255,255,.08);
  padding: 16px 14px;
  display:flex;
  flex-direction:column;
  gap: 12px;
  align-items:center;
}

.avatarCol{
  width:100%;
  flex:1;
  min-height:0;
  display:flex;
  flex-direction:column;
  gap: 12px;
  align-items:center;
}

.avatarFrame{
  width:100%;
  height: 100%;
  min-height: 420px;
  border-radius: 26px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.18);
  overflow:hidden;
  position:relative;
  box-shadow: 0 18px 55px rgba(0,0,0,.40);
}
.avatarFrame::before{
  content:"";
  position:absolute;
  inset:-40%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
  transform: rotate(18deg) translateX(-160%);
  animation: sheen 3.6s ease-in-out infinite;
  opacity:.65;
}
@keyframes sheen{
  0%{ transform: rotate(18deg) translateX(-160%); }
  55%{ transform: rotate(18deg) translateX(160%); }
  100%{ transform: rotate(18deg) translateX(160%); }
}

.avatar{
  width:100%;
  height:100%;
  object-fit: contain;
  filter: drop-shadow(0 30px 55px rgba(0,0,0,.55));
  transform: translateY(6px) scale(1.03);
}

.playerName{
  font-weight: 950;
  font-size: 22px;
  text-align:center;
  text-shadow: 0 16px 34px rgba(0,0,0,.55);
}

.levelPill{
  display:inline-flex;
  align-items:center;
  gap: 10px;
  padding: 9px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.14);
  background: linear-gradient(180deg, rgba(255,150,70,.18), rgba(80,170,255,.10));
  box-shadow: 0 16px 44px rgba(0,0,0,.25);
  backdrop-filter: blur(10px);
  font-weight: 950;
  letter-spacing: .25px;
  white-space: nowrap;
}
.levelDot{
  width: 10px; height: 10px; border-radius: 999px;
  background: rgba(255,176,90,1);
  box-shadow: 0 0 0 5px rgba(255,176,90,.18);
}

/* RIGHT */
.right{
  position:relative;
  z-index:1;
  padding: 16px 16px 14px 16px;
  display:flex;
  flex-direction:column;
  gap: 12px;
  min-height:0;
}

/* Top row */
.topRow{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: 12px;
  flex-wrap:wrap;
}
.title{
  font-weight: 950;
  font-size: 22px;
  letter-spacing: .25px;
  text-shadow: 0 16px 34px rgba(0,0,0,.55);
  display:flex;
  align-items:center;
  gap: 10px;
}
.titleIcon{
  width: 34px; height: 34px;
  border-radius: 14px;
  display:grid;
  place-items:center;
  background: linear-gradient(180deg, rgba(255,150,70,.20), rgba(80,170,255,.10));
  border: 1px solid rgba(255,255,255,.12);
  box-shadow: 0 14px 34px rgba(0,0,0,.22);
}

.progressWrap{
  display:flex;
  align-items:center;
  gap: 10px;
  color: rgba(255,255,255,.82);
  font-weight: 950;
  font-size: 12px;
  white-space:nowrap;
}
.progressShell{
  width: 280px;
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.10);
  border: 1px solid rgba(255,255,255,.12);
  overflow:hidden;
}
.progressBar{
  height:100%;
  width:0%;
  background: linear-gradient(90deg, rgba(80,170,255,.95), rgba(255,200,80,.95), rgba(255,120,50,.95));
  transition: width .55s cubic-bezier(.2,.8,.2,1);
}

/* List */
.list{
  flex:1;
  min-height:0;
  overflow:auto;
  padding-right: 6px;
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.list::-webkit-scrollbar{ width: 10px; }
.list::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.18);
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.18);
}
.list::-webkit-scrollbar-track{
  background: rgba(0,0,0,.16);
  border-radius: 999px;
}

/* Badge card (style jeu + hover) */
.badgeItem{
  display:flex;
  align-items:center;
  gap: 14px;
  padding: 12px 14px;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.18));
  box-shadow: var(--shadow2);
  position:relative;
  overflow:hidden;

  transform: translateY(10px);
  opacity: 0;
  animation: inUp .55s cubic-bezier(.2,.8,.2,1) forwards;
}
.badgeItem::after{
  content:"";
  position:absolute; inset:-2px;
  pointer-events:none;
  background:
    radial-gradient(420px 160px at 15% 0%, rgba(255,150,70,.16), transparent 60%),
    radial-gradient(520px 220px at 85% 120%, rgba(80,170,255,.10), transparent 60%);
  opacity:.9;
}
.badgeItem:hover{
  transform: translateY(-2px) !important;
  filter: brightness(1.05);
  border-color: rgba(255,255,255,.18);
}

@keyframes inUp{
  to{ transform: translateY(0); opacity: 1; }
}

.badgeImgWrap{
  width: 74px;
  height: 74px;
  border-radius: 22px;
  display:grid;
  place-items:center;
  background: rgba(0,0,0,.18);
  border: 1px solid rgba(255,255,255,.12);
  position:relative;
  overflow:hidden;
}
.badgeImgWrap::before{
  content:"";
  position:absolute; inset:-40%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.20), transparent);
  transform: rotate(20deg) translateX(-160%);
  animation: badgeShine 3.2s ease-in-out infinite;
  opacity:.55;
}
@keyframes badgeShine{
  0%{ transform: rotate(20deg) translateX(-160%); }
  55%{ transform: rotate(20deg) translateX(160%); }
  100%{ transform: rotate(20deg) translateX(160%); }
}

.badgeImg{
  width: 56px;
  height: 56px;
  object-fit: contain;
  filter: drop-shadow(0 14px 26px rgba(0,0,0,.48));
}

.badgeInfo{ flex:1; min-width:0; position:relative; z-index:1; }
.badgeTitle{
  font-weight: 950;
  font-size: 14px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.badgeMeta{
  margin-top: 7px;
  display:flex;
  flex-wrap:wrap;
  gap: 8px;
  font-size: 12px;
  font-weight: 900;
  color: rgba(255,255,255,.80);
}
.pill{
  padding: 6px 9px;
  border-radius: 999px;
  background: rgba(0,0,0,.18);
  border: 1px solid rgba(255,255,255,.08);
  white-space:nowrap;
}

.tag{
  font-weight: 950;
  font-size: 12px;
  padding: 7px 11px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.18);
  white-space:nowrap;
  box-shadow: 0 14px 34px rgba(0,0,0,.18);
  position:relative;
  z-index:1;
}
.tag.OR{ border-color: rgba(255,200,80,.35); background: rgba(255,200,80,.10); }
.tag.ARGENT{ border-color: rgba(210,220,235,.35); background: rgba(210,220,235,.10); }
.tag.BRONZE{ border-color: rgba(255,150,70,.40); background: rgba(255,150,70,.10); }

/* Bottom actions */
.bottomRow{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: 12px;
  flex-wrap:wrap;
}

.hintTxt{
  color: rgba(255,255,255,.72);
  font-weight: 900;
  font-size: 12px;
}

.btnPrimary{
  border:none;
  background: linear-gradient(180deg, rgba(255,176,90,1), rgba(255,120,50,1));
  color: rgba(10,12,18,.96);
  border-radius: 12px;
  padding: 10px 14px;
  font-weight: 950;
  letter-spacing: .2px;
  cursor: pointer;
  box-shadow: 0 18px 50px rgba(0,0,0,.25);
  transition: transform .12s ease, filter .12s ease;
}
.btnPrimary:hover{ transform: translateY(-1px); filter: brightness(1.05); }
.btnPrimary:active{ transform: translateY(0px); }

.btnNeo{
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.14);
  color: rgba(255,255,255,.92);
  border-radius: 12px;
  padding: 10px 12px;
  font-weight: 950;
  letter-spacing: .2px;
  cursor: pointer;
}

/* Empty state */
.empty{
  padding: 14px 14px;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.18);
  color: rgba(255,255,255,.82);
  font-weight: 900;
  box-shadow: var(--shadow2);
}

/* ‚úÖ Overlay "Pr√™t pour la nouvelle mission" */
.fullOverlay{
  position: fixed;
  inset: 0;
  display:none;
  z-index: 999;
  background: rgba(0,0,0,.92);
  align-items:center;
  justify-content:center;
}
.fullBox{
  width: min(980px, 92%);
  text-align:center;
  padding: 26px 18px 18px;
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.35);
  box-shadow: 0 30px 90px rgba(0,0,0,.70);
}
.readyTitle{
  font-weight: 950;
  font-size: clamp(22px, 3.1vw, 34px);
  text-shadow: 0 16px 40px rgba(0,0,0,.65);
}
.readySub{
  margin-top: 10px;
  color: rgba(255,255,255,.72);
  font-weight: 900;
}
.readyActions{
  margin-top: 20px;
  display:flex;
  justify-content:center;
  gap: 12px;
  flex-wrap:wrap;
}

/* Responsive */
@media (max-width: 980px){
  .bigWrap{ grid-template-columns: 1fr; }
  .left{ border-right: none; border-bottom: 1px solid rgba(255,255,255,.08); }
  .avatarFrame{ min-height: 260px; }
  .progressShell{ width: 220px; }
}
</style>
</head>

<body>
<div class="stage">
  <div class="bigWrap" id="bigWrap">

    <!-- LEFT -->
    <div class="left">
      <div class="avatarCol">
        <div class="avatarFrame">
          <img id="avatar" class="avatar" alt="avatar">
        </div>
        <div class="playerName" id="pname">Dr. Joueur</div>
        <div class="levelPill" id="plevel"><span class="levelDot"></span> NIVEAU : D√âBUTANT</div>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="right">
      <div class="topRow">
        <div class="title">
          <span class="titleIcon">üèÖ</span>
          <span>Badges gagn√©s</span>
        </div>

        <div class="progressWrap">
          <span id="pcount">0/4</span>
          <div class="progressShell"><div class="progressBar" id="pbar"></div></div>
        </div>
      </div>

      <div id="badgesList" class="list"></div>

      <div id="empty" class="empty" style="display:none;">
        Aucun badge trouv√© pour ce niveau. Termine une mission pour d√©bloquer tes badges.
      </div>

      <div class="bottomRow">
        <div class="hintTxt" id="hintTxt">Chaque seconde compte‚Ä¶ garde ton sang-froid.</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btnNeo" id="btnRefresh" type="button">üîÑ Actualiser</button>
          <button class="btnPrimary" id="btnNext" type="button">‚û° Suivant</button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ‚úÖ Overlay noir -->
<div class="fullOverlay" id="readyOverlay">
  <div class="fullBox">
    <div class="readyTitle">Pr√™t pour la nouvelle mission ?</div>
    <div class="readySub">Respire, observe, puis agis avec pr√©cision.</div>

    <div class="readyActions">
      <button class="btnPrimary" id="btnYes" type="button">‚úÖ Oui</button>
      <button class="btnNeo" id="btnNo" type="button">‚úñ Non</button>
    </div>
  </div>
</div>

<script>
/* =====================================================
   ‚úÖ CONFIG
===================================================== */
// üîÅ Remplace par la page / URL du sc√©nario suivant
const NEXT_SCENARIO_URL = "#";

// ‚úÖ Nombre total de sc√©narios (progression 4/4)
const TOTAL_SCENARIOS = 4;

// Dossier avatars (comme ton moteur)
const AVATAR_BASE = "assets/avatars/";

// Images badges (comme ton moteur)
const BADGE_IMG_FALLBACK = {
  OR: "assets/or.png",
  ARGENT: "assets/argent.png",
  BRONZE: "assets/bronze.png"
};

/* =====================================================
   ‚úÖ SFX (coh√©rent avec ton moteur WebAudio)
===================================================== */
let audioCtx = null;
function ensureAudio(){
  if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
}
function tone(freq, dur=0.08, type="sine", gain=0.05){
  ensureAudio();
  const t0 = audioCtx.currentTime;
  const osc = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  osc.type = type; osc.frequency.value = freq;
  g.gain.value = gain;
  osc.connect(g); g.connect(audioCtx.destination);
  osc.start(t0); osc.stop(t0 + dur);
}
function sfxClick(){ tone(520,0.04,"triangle",0.035); }
function sfxBadge(){ tone(660,0.06,"sine",0.06); setTimeout(()=>tone(880,0.07,"sine",0.06), 75); }
function sfxVictory(){
  ensureAudio();
  const notes = [{f:659,d:0.09},{f:784,d:0.10},{f:988,d:0.12},{f:1175,d:0.16}];
  let t=0;
  notes.forEach(n=>{ setTimeout(()=>tone(n.f,n.d,"sine",0.06), t*1000); t += n.d + 0.03; });
}

/* =====================================================
   ‚úÖ Utils
===================================================== */
const $ = (id)=>document.getElementById(id);

function escapeHtml(str){
  return String(str||"")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function normDifficulty(raw){
  const d = String(raw||"").toLowerCase();
  if(d.includes("expert")) return "EXPERT";
  if(d.includes("inter")) return "INTERM√âDIAIRE";
  return "D√âBUTANT";
}

function getDifficulty(){
  const raw =
    (typeof window.niveau !== "undefined" && window.niveau) ? window.niveau :
    (localStorage.getItem("niveau") || localStorage.getItem("difficulty") || "d√©butant");
  return normDifficulty(raw);
}

function getPlayer(){
  return localStorage.getItem("playerName")
    || localStorage.getItem("player_name")
    || (typeof window.player_name !== "undefined" ? window.player_name : "")
    || (typeof window.playerName !== "undefined" ? window.playerName : "")
    || "Joueur";
}

function getAvatar(){
  return localStorage.getItem("avatar") || "medecin_f.png";
}

/* =====================================================
   ‚úÖ Lire badges (robuste)
   - badges_history (si pr√©sent)
   - scan badge_s* (toutes variantes)
===================================================== */
function readBadgesFromHistory(targetDifficulty){
  let arr = [];
  try{ arr = JSON.parse(localStorage.getItem("badges_history") || "[]"); }catch(e){ arr=[]; }
  if(!Array.isArray(arr)) return [];

  const out = [];
  arr.forEach(b=>{
    const diff = normDifficulty(b.niveau || b.difficulty || b.level || "");
    if(diff !== targetDifficulty) return;

    const sid = Number(b.scenarioId ?? b.scenario ?? b.scenario_id ?? NaN);
    if(!Number.isFinite(sid)) return;

    const type = String(b.badgeLevel || b.badgeType || b.type || "BRONZE").toUpperCase();
    out.push({
      scenarioId: sid,
      scenarioLabel: b.scenarioLabel || b.label || ("Sc√©nario " + sid),
      mission: b.mission || "",
      difficulty: diff,
      badgeLevel: type,
      badgeImage: b.badgeImage || b.img || BADGE_IMG_FALLBACK[type] || BADGE_IMG_FALLBACK.BRONZE,
      score: Number(b.score ?? 0),
      date: Number(b.date ?? b.ts ?? Date.now())
    });
  });
  return out;
}

function scanBadgesFromLocalStorage(targetDifficulty){
  const out = [];
  const keys = Object.keys(localStorage);

  keys.forEach(k=>{
    if(!k.startsWith("badge_s")) return;
    if(k === "badges_history") return;

    let v=null;
    try{ v = JSON.parse(localStorage.getItem(k)||"null"); }catch(e){ v=null; }
    if(!v || typeof v !== "object") return;

    const sid = Number(v.scenarioId ?? v.scenario ?? v.scenario_id ?? NaN);
    if(!Number.isFinite(sid)) return;

    // difficult√©: soit dans l'objet, soit dans la cl√© si tu utilises badge_s1_DEBUTANT
    let diff = normDifficulty(v.difficulty || v.niveau || v.level || "");
    if(!String(v.difficulty||v.niveau||"").trim()){
      const up = k.toUpperCase();
      if(up.includes("EXPERT")) diff = "EXPERT";
      else if(up.includes("INTER")) diff = "INTERM√âDIAIRE";
      else if(up.includes("DEB")) diff = "D√âBUTANT";
    }
    if(diff !== targetDifficulty) return;

    const type = String(v.badgeLevel || v.badgeType || v.type || "BRONZE").toUpperCase();
    out.push({
      scenarioId: sid,
      scenarioLabel: v.scenarioLabel || v.label || ("Sc√©nario " + sid),
      mission: v.mission || "",
      difficulty: diff,
      badgeLevel: type,
      badgeImage: v.badgeImage || v.img || BADGE_IMG_FALLBACK[type] || BADGE_IMG_FALLBACK.BRONZE,
      score: Number(v.score ?? 0),
      date: Number(v.date ?? v.ts ?? Date.now())
    });
  });

  return out;
}

function uniqueByScenario(arr){
  const map = new Map();
  arr.forEach(b=>{
    const prev = map.get(b.scenarioId);
    if(!prev || (b.date||0) > (prev.date||0)) map.set(b.scenarioId, b);
  });
  return [...map.values()].sort((a,b)=>a.scenarioId - b.scenarioId);
}

/* =====================================================
   ‚úÖ Render
===================================================== */
const DIFF = getDifficulty();

// Header left
$("pname").textContent = "Dr. " + getPlayer();
$("plevel").innerHTML = `<span class="levelDot"></span> NIVEAU : ${escapeHtml(DIFF)}`;
$("avatar").src = AVATAR_BASE + getAvatar();

function renderBadges(){
  const host = $("badgesList");
  const empty = $("empty");
  const pcount = $("pcount");
  const pbar = $("pbar");

  const fromHist = readBadgesFromHistory(DIFF);
  const fromScan = scanBadgesFromLocalStorage(DIFF);

  // ‚úÖ seulement badges gagn√©s
  const badges = uniqueByScenario([...fromHist, ...fromScan]).filter(b => Number(b.scenarioId) >= 1);

  // Progress
  const n = badges.length;
  pcount.textContent = n + "/" + TOTAL_SCENARIOS;
  pbar.style.width = Math.round((n / TOTAL_SCENARIOS) * 100) + "%";

  if(n === 0){
    host.innerHTML = "";
    empty.style.display = "block";
    return;
  }
  empty.style.display = "none";

  // ‚úÖ apparition s√©quentielle
  host.innerHTML = badges.map((b, i)=>{
    const lvl = escapeHtml(String(b.badgeLevel||"BRONZE").toUpperCase());
    const title = escapeHtml(b.scenarioLabel || ("Sc√©nario " + b.scenarioId));
    const mission = escapeHtml(b.mission || "");
    const score = escapeHtml(String(b.score ?? 0));
    const diff = escapeHtml(b.difficulty || DIFF);

    const img = escapeHtml(b.badgeImage || BADGE_IMG_FALLBACK[lvl] || BADGE_IMG_FALLBACK.BRONZE);
    const delay = (i * 80); // ms

    return `
      <div class="badgeItem" style="animation-delay:${delay}ms;">
        <div class="badgeImgWrap">
          <img class="badgeImg" src="${img}" alt="${lvl}">
        </div>

        <div class="badgeInfo">
          <div class="badgeTitle">${title}${mission ? " ‚Äî " + mission : ""}</div>
          <div class="badgeMeta">
            <span class="pill">‚≠ê ${score}</span>
            <span class="pill">üéö ${diff}</span>
            <span class="pill">#${escapeHtml(String(b.scenarioId))}</span>
          </div>
        </div>

        <div class="tag ${lvl}">${lvl}</div>
      </div>
    `;
  }).join("");

  // Son ‚Äúapparition badges‚Äù (l√©ger)
  try{ sfxBadge(); }catch(e){}
}

/* =====================================================
   ‚úÖ Boutons
===================================================== */
$("btnRefresh").addEventListener("click", ()=>{
  ensureAudio(); sfxClick();
  renderBadges();
});

$("btnNext").addEventListener("click", ()=>{
  ensureAudio(); sfxClick();
  $("readyOverlay").style.display = "flex";
});

$("btnNo").addEventListener("click", ()=>{
  sfxClick();
  $("readyOverlay").style.display = "none";
});

$("btnYes").addEventListener("click", ()=>{
  sfxVictory();
  // petite pause tr√®s courte pour laisser le son d√©marrer
  setTimeout(()=>{ window.location.href = NEXT_SCENARIO_URL; }, 180);
});

// Fermer overlay si clic dehors (optionnel)
$("readyOverlay").addEventListener("click", (e)=>{
  if(e.target === $("readyOverlay")){
    sfxClick();
    $("readyOverlay").style.display = "none";
  }
});

/* =====================================================
   ‚úÖ Init
===================================================== */
(function init(){
  // Astuce texte dynamique optionnel
  const lines = [
    "Chaque seconde compte‚Ä¶ garde ton sang-froid.",
    "Observe. D√©cide. Agis.",
    "Reste pr√©cis, m√™me sous pression.",
    "Un bon geste vaut une vie."
  ];
  $("hintTxt").textContent = lines[Math.floor(Math.random()*lines.length)];

  renderBadges();
})();
</script>
</body>
</html>
