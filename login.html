<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Urgences ‚Äì Accueil</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">

<style>
  html, body { background: transparent; margin: 0; color: #fff; }

  /* ‚úÖ Genially: sc√®ne fixe 1980x1020 + scale auto */
  .genially-stage{
    width: 100vw; height: 100vh;
    display:flex; align-items:center; justify-content:center;
    overflow:hidden;
  }
  .genially-page{
    width: 1980px;
    height: 1020px;
    position: relative;
    transform-origin: center;
  }

  .fx-overlay{
    position:absolute; inset:0; pointer-events:none;
    background:
      radial-gradient(1200px 520px at 50% 16%, rgba(255,255,255,.14), transparent 58%),
      radial-gradient(1000px 620px at 16% 86%, rgba(255,120,80,.10), transparent 62%),
      radial-gradient(1000px 620px at 84% 86%, rgba(90,150,255,.14), transparent 62%),
      radial-gradient(1200px 900px at 50% 58%, transparent 55%, rgba(0,0,0,.46) 100%),
      linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.18));
    filter: blur(.2px);
  }

  .fx-grain{
    position:absolute; inset:0; pointer-events:none;
    opacity:.22; mix-blend-mode: overlay;
    background-image:
      repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, transparent 1px 3px),
      repeating-linear-gradient(90deg, rgba(255,255,255,.02) 0 1px, transparent 1px 4px);
  }

  .page-wrap{
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    padding: 48px 64px;
  }
  .container{ max-width: 1400px; }

  /* ========================= TITRE ========================= */
  .gameTitleWrap{
    text-align:center;
    margin-bottom: 20px;
    position: relative;
    isolation: isolate;
  }

  .titlePill{
    display:inline-flex;
    align-items:center;
    gap: 10px;
    padding: 14px 26px;
    border-radius: 999px;
    background: rgba(0,0,0,.44);
    border: 1px solid rgba(255,255,255,.18);
    backdrop-filter: blur(12px);
    box-shadow: 0 26px 90px rgba(0,0,0,.48);
    letter-spacing: .22em;
    text-transform: uppercase;
    font-weight: 900;
    font-size: 18px;
    color: rgba(255,255,255,.92);
    margin-bottom: 12px;
    position: relative;
    overflow:hidden;
  }

  .pillIcon{
    width: 32px; height: 32px;
    border-radius: 12px;
    background: rgba(0,0,0,.35);
    border: 1px solid rgba(255,255,255,.14);
    display:grid; place-items:center;
    box-shadow: 0 20px 60px rgba(0,0,0,.35);
    font-size: 18px;
  }

  .titlePill::after{
    content:"";
    position:absolute;
    top:-50%; left:-40%;
    width: 40%; height: 220%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
    transform: rotate(18deg);
    animation: shimmer 3.2s linear infinite;
    opacity:.65;
    pointer-events:none;
  }
  @keyframes shimmer{
    0%{ transform: translateX(-120%) rotate(18deg); }
    100%{ transform: translateX(340%) rotate(18deg); }
  }

  .gameTitle, .gameSubtitle{
    font-family:'Anton', sans-serif;
    text-transform:uppercase;
    font-size: 86px;
    line-height: .90;
    margin: 0;
    letter-spacing:.05em;
  }

  .gameTitle{
    background: linear-gradient(180deg, #f2f8ff 0%, #9fd0ff 42%, #d7e9ff 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow:
      0 16px 44px rgba(0,0,0,.62),
      0 0 70px rgba(120,190,255,.34);
    filter: drop-shadow(0 26px 85px rgba(0,0,0,.74));
    position: relative;
  }

  .gameTitle::after{
    content:"";
    position:absolute;
    top:0; left:-30%;
    width: 35%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
    transform: skewX(-18deg);
    animation: titleSweep 4.2s ease-in-out infinite;
    opacity:.7;
    pointer-events:none;
  }
  @keyframes titleSweep{
    0%{ transform: translateX(-140%) skewX(-18deg); opacity:0; }
    18%{ opacity:.75; }
    55%{ opacity:.65; }
    72%{ opacity:0; }
    100%{ transform: translateX(460%) skewX(-18deg); opacity:0; }
  }

  .gameSubtitle{
    margin-top: 8px;
    letter-spacing:.03em;
    color: rgba(255,255,255,.98);
    text-shadow:
      0 22px 62px rgba(0,0,0,.78),
      0 0 64px rgba(255,255,255,.10);
  }

  /* ========================= CARD NOM ========================= */
  .nameCard{
    margin: 0 auto;
    width: min(1000px, 100%);
    background: rgba(0,0,0,.42);
    border: 1px solid rgba(255,255,255,.20);
    border-radius: 26px;
    padding: 20px;
    backdrop-filter: blur(14px);
    box-shadow:
      0 30px 140px rgba(0,0,0,.50),
      0 0 60px rgba(120,190,255,.10);
    position: relative;
    overflow:hidden;
  }
  .nameCard::before{
    content:"";
    position:absolute; inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 36%, rgba(140,200,255,.14));
    opacity:.16;
    pointer-events:none;
  }

  .nameLabel{
    font-size: 17px;
    letter-spacing: .14em;
    text-transform: uppercase;
    color: rgba(255,255,255,.84);
    margin: 0 0 10px;
    font-weight: 900;
    display:flex;
    align-items:center;
    gap:10px;
    text-shadow: 0 16px 55px rgba(0,0,0,.60);
  }
  .labelIcon{
    width: 30px; height: 30px;
    border-radius: 12px;
    background: rgba(0,0,0,.34);
    border: 1px solid rgba(255,255,255,.14);
    display:grid; place-items:center;
    box-shadow: 0 18px 55px rgba(0,0,0,.28);
  }

  .inputWrap{ position:relative; }
  .inputGlow{
    position:absolute; inset:-2px;
    border-radius: 18px;
    background: radial-gradient(800px 120px at 50% 0%, rgba(140,200,255,.20), transparent 58%);
    opacity:.65;
    pointer-events:none;
    filter: blur(10px);
  }

  .nameInput{
    position:relative;
    width: 100%;
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.22);
    background: rgba(0,0,0,.34);
    color: #fff;
    padding: 14px 18px;
    outline: none;
    font-size: 19px;
    box-shadow:
      inset 0 0 0 1px rgba(255,255,255,.06),
      0 18px 60px rgba(0,0,0,.18);
  }

  .actionRow{
    display:flex;
    gap: 14px;
    flex-wrap: wrap;
    margin-top: 14px;
    justify-content:center;
  }

  .btnGlass{
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.24);
    background: rgba(0,0,0,.40);
    color: #fff;
    padding: 14px 24px;
    font-weight: 900;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-size: 14px;
    box-shadow: 0 24px 95px rgba(0,0,0,.42);
    transition: transform .15s ease, filter .15s ease, box-shadow .15s ease, border-color .15s ease;
    position: relative;
    overflow:hidden;
    display:inline-flex;
    align-items:center;
    gap:10px;
  }
  .btnGlass:hover{
    transform: translateY(-3px);
    filter: brightness(1.10);
    border-color: rgba(140,200,255,.55);
    box-shadow: 0 36px 140px rgba(0,0,0,.58);
  }
  .btnGlass:disabled{ opacity: .45; cursor: not-allowed; transform:none; filter:none; }

  .btnPrimary{
    border: 1px solid rgba(255,165,0,.38);
    background: linear-gradient(180deg, rgba(255,176,90,.18), rgba(0,0,0,.40));
  }

  .bottomTag{
    margin-top: 18px;
    text-align:center;
    font-weight: 900;
    letter-spacing: .12em;
    text-transform: uppercase;
    font-size: 17px;
    color: rgba(255,255,255,.88);
    text-shadow: 0 18px 70px rgba(0,0,0,.70);
    display:flex;
    gap:12px;
    align-items:center;
    justify-content:center;
  }

  /* ‚úÖ Screens */
  .screen{ display:none; }
  .screen.active{ display:block; }

  /* =========================
     ‚úÖ R√àGLES: FULLSCREEN NOIR
     ========================= */
  .rulesFull{
    position:absolute; inset:0;
    background:
      radial-gradient(1200px 520px at 50% 18%, rgba(255,255,255,.10), transparent 55%),
      radial-gradient(900px 520px at 18% 78%, rgba(255,120,80,.08), transparent 60%),
      radial-gradient(900px 520px at 82% 78%, rgba(90,150,255,.10), transparent 60%),
      radial-gradient(1200px 900px at 50% 55%, transparent 55%, rgba(0,0,0,.88) 100%),
      linear-gradient(180deg, rgba(0,0,0,.98), rgba(0,0,0,.96));
    display:flex;
    align-items:center;
    justify-content:center;
    padding: 38px 50px;
  }

  .rulesContainer{ max-width: 1500px; width:100%; }

  .rulesGlass{
    width: min(1460px, 100%);
    margin: 0 auto;
    background: rgba(0,0,0,.42);
    border: 1px solid rgba(255,255,255,.14);
    backdrop-filter: blur(12px);
    border-radius: 26px;
    box-shadow: 0 22px 80px rgba(0,0,0,.55);
    overflow: hidden;
    position: relative;
  }

  .rulesHeader{
    padding: 16px 22px 14px;
    border-bottom: 1px solid rgba(255,255,255,.10);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    flex-wrap: wrap;
  }

  .helloRules{
    margin:0;
    font-weight: 900;
    font-size: 26px;
    text-shadow: 0 12px 30px rgba(0,0,0,.55);
  }
  .helloRules .name{
    color: rgba(255,190,110,1);
    text-shadow: 0 0 14px rgba(255,165,0,.35);
  }

  .stepPill{
    display:inline-flex;
    align-items:center;
    gap: 10px;
    padding: 9px 12px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.26);
    color: rgba(255,255,255,.90);
    font-size: 12px;
    font-weight: 900;
    letter-spacing:.14em;
    text-transform: uppercase;
    white-space: nowrap;
  }
  .stepDot{
    width: 10px; height: 10px;
    border-radius: 999px;
    background: rgba(140,200,255,.22);
    border: 1px solid rgba(140,200,255,.55);
    box-shadow: 0 0 14px rgba(140,200,255,.22);
  }

  .rulesBody{ padding: 16px 20px 18px; }

  .rulesGrid{
    display:grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 16px;
    align-items: stretch;
  }

  .panel{
    background: rgba(0,0,0,.22);
    border: 1px solid rgba(255,255,255,.12);
    border-radius: 22px;
    padding: 16px 16px 14px;
    box-shadow: 0 18px 60px rgba(0,0,0,.28);
    position: relative;
    overflow:hidden;
  }
  .panel::before{
    content:"";
    position:absolute;
    inset:-2px;
    background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 40%, rgba(255,255,255,.06));
    opacity:.16;
    pointer-events:none;
  }

  .panelTitle{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    margin: 0 0 10px;
  }
  .panelTitle h3{
    margin:0;
    font-weight: 900;
    letter-spacing:.12em;
    text-transform: uppercase;
    font-size: 17px;
    color: rgba(255,255,255,.92);
  }

  .tag{
    padding: 7px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.16);
    background: rgba(0,0,0,.22);
    font-size: 12px;
    font-weight: 900;
    letter-spacing:.12em;
    text-transform: uppercase;
    color: rgba(255,255,255,.84);
    white-space: nowrap;
  }

  .ruleText{
    margin:0 0 12px;
    color: rgba(255,255,255,.85);
    font-size: 15px;
    line-height: 1.55;
  }

  .bullets{
    margin: 0;
    padding-left: 18px;
    color: rgba(255,255,255,.78);
    font-size: 14px;
    line-height: 1.55;
  }
  .bullets li{ margin: 6px 0; }

  .visual{ display:flex; flex-direction:column; justify-content:space-between; gap: 14px; height:100%; }

  .bigStat{
    position: relative;
    border-radius: 24px;
    padding: 16px 16px 14px;
    background: linear-gradient(180deg, rgba(0,0,0,.24), rgba(0,0,0,.18));
    border: 1px solid rgba(255,255,255,.14);
    box-shadow: 0 22px 80px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05);
    overflow:hidden;
  }

  .statTop{ display:flex; align-items:center; justify-content:space-between; gap: 10px; position: relative; z-index:1; }
  .statLabel{
    font-size: 12px;
    letter-spacing:.20em;
    text-transform: uppercase;
    color: rgba(255,255,255,.72);
    font-weight: 900;
    margin:0;
  }
  .chip{
    display:inline-flex;
    align-items:center;
    gap: 8px;
    padding: 7px 11px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.22);
    color: rgba(255,255,255,.90);
    font-size: 12px;
    font-weight: 900;
    letter-spacing:.12em;
    text-transform: uppercase;
    white-space: nowrap;
  }
  .chip .dot{
    width: 10px; height: 10px;
    border-radius: 999px;
    border: 1px solid rgba(140,200,255,.55);
    background: rgba(140,200,255,.18);
    box-shadow: 0 0 14px rgba(140,200,255,.25);
  }

  .statValue{
    font-family:'Anton', sans-serif;
    font-size: 68px;
    letter-spacing:.06em;
    margin: 10px 0 6px;
    line-height:1;
    background: linear-gradient(180deg, #ffd9a0 0%, #ffb05a 55%, #ff7832 100%);
    -webkit-background-clip:text;
    background-clip:text;
    color:transparent;
    text-shadow: 0 18px 60px rgba(0,0,0,.55);
    position: relative;
    z-index:1;
  }

  .statMeter{
    height: 10px;
    border-radius: 999px;
    background: rgba(255,255,255,.10);
    border: 1px solid rgba(255,255,255,.12);
    overflow:hidden;
    position: relative;
    z-index:1;
    margin: 6px 0 12px;
  }
  .statMeter > span{
    display:block;
    height:100%;
    width: 72%;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(140,200,255,.95), rgba(255,165,0,.85));
  }

  .statHint{
    margin: 0;
    color: rgba(255,255,255,.82);
    font-size: 15px;
    line-height: 1.45;
    position: relative;
    z-index:1;
  }

  .miniRow{ display:grid; grid-template-columns: 1fr 1fr; gap: 14px; }
  .mini{
    position: relative;
    border-radius: 20px;
    padding: 14px 14px 13px;
    background: rgba(0,0,0,.20);
    border: 1px solid rgba(255,255,255,.12);
    box-shadow: 0 18px 55px rgba(0,0,0,.30);
    overflow:hidden;
  }
  .miniTitle{
    display:flex;
    align-items:center;
    gap: 10px;
    margin:0 0 8px;
    font-weight: 900;
    letter-spacing:.12em;
    text-transform: uppercase;
    font-size: 12px;
    color: rgba(255,255,255,.78);
  }
  .miniIcon{
    width: 34px; height: 34px;
    border-radius: 14px;
    display:grid; place-items:center;
    background: rgba(140,200,255,.12);
    border: 1px solid rgba(140,200,255,.22);
    box-shadow: 0 10px 28px rgba(0,0,0,.22);
    flex: 0 0 auto;
  }
  .miniText{ margin:0; color: rgba(255,255,255,.88); font-size: 14px; line-height:1.45; }

  .navBar{
    margin-top: 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    flex-wrap: wrap;
  }

  .dots{ display:flex; gap: 10px; align-items:center; }
  .dotBtn{
    width: 12px; height: 12px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.22);
    background: rgba(255,255,255,.10);
    box-shadow: 0 10px 30px rgba(0,0,0,.22);
    cursor:pointer;
  }
  .dotBtn.active{
    background: rgba(140,200,255,.28);
    border-color: rgba(140,200,255,.55);
    box-shadow: 0 0 16px rgba(140,200,255,.22);
  }

  .btnRow{ display:flex; gap: 10px; align-items:center; }

  .btn-ghost{
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.18);
    background: rgba(0,0,0,.18);
    color: rgba(255,255,255,.90);
    padding: 12px 16px;
    font-weight: 900;
    letter-spacing: .10em;
    text-transform: uppercase;
    font-size: 12px;
    transition: transform .15s ease, filter .15s ease;
  }
  .btn-ghost:hover{ transform: translateY(-2px); filter: brightness(1.08); }

  .btn-ember{
    border:0;
    border-radius: 14px;
    padding: 12px 16px;
    font-weight: 900;
    letter-spacing:.10em;
    text-transform: uppercase;
    font-size: 12px;
    background: linear-gradient(180deg,#ffb05a,#ff7832);
    color: #0a0c12;
    box-shadow: 0 16px 35px rgba(255,120,50,.22);
    transition: transform .15s ease, filter .15s ease;
    display:inline-flex;
    align-items:center;
    gap: 10px;
  }
  .btn-ember:hover{ transform: translateY(-2px); filter: brightness(1.06); }
  .btn-ember:disabled{ opacity: .45; cursor: not-allowed; transform:none; filter:none; }

  .footer{
    padding: 14px 18px;
    border-top: 1px solid rgba(255,255,255,.10);
    text-align:center;
    font-size: 13px;
    color: rgba(255,255,255,.75);
  }

  /* ‚úÖ bouton mission (en bas) */
  .missionBar{
    margin-top: 12px;
    display:flex;
    justify-content:center;
  }
  .btnMission{
    min-width: 320px;
    justify-content:center;
    padding: 14px 18px;
    font-size: 12px;
    border: 1px solid rgba(140,200,255,.40);
  }

  .step{ display:none; }
  .step.active{ display:block; animation: stepIn .34s ease; }
  @keyframes stepIn{
    from{ opacity:0; transform: translateY(16px) scale(.99); filter: blur(2px); }
    to{ opacity:1; transform: translateY(0) scale(1); filter: blur(0); }
  }

  .shake{ animation: shake .22s ease; }
  @keyframes shake{
    0%{ transform: translateX(0); }
    30%{ transform: translateX(-3px); }
    60%{ transform: translateX(3px); }
    100%{ transform: translateX(0); }
  }

  @media (max-width: 1200px){
    .rulesGrid{ grid-template-columns: 1fr; }
    .miniRow{ grid-template-columns: 1fr 1fr; }
  }
</style>
</head>

<body>
  <div class="genially-stage">
    <div class="genially-page" id="geniallyPage">
      <div class="fx-overlay"></div>
      <div class="fx-grain"></div>

      <div class="page-wrap">
        <div class="container">

          <!-- ‚úÖ √âCRAN 1 : ACCUEIL -->
          <div class="screen active" id="screenHome">
            <div class="gameTitleWrap">
              <div class="titlePill">
                <span>MISSION ‚Ä¢ PREMIERS SECOURS</span>
              </div>
              <h1 class="gameTitle">URGENCES</h1>
              <div class="gameSubtitle">AGIR POUR SAUVER</div>
            </div>

            <div class="nameCard">
              <p class="nameLabel">
                Votre nom
              </p>

              <div class="inputWrap">
                <div class="inputGlow"></div>
                <input id="playerName" class="nameInput" type="text" placeholder="Entrez votre nom‚Ä¶" autocomplete="off" />
              </div>

              <div class="actionRow">
                <button id="saveBtn" class="btnGlass btnPrimary" type="button">ENREGISTRER</button>
                <button id="nextBtn" class="btnGlass" type="button" disabled>SUIVANT</button>
                <button id="continueBtn" class="btnGlass" type="button" style="display:none;">COMMENCER LA MISSION</button>
              </div>
            </div>

            <div class="bottomTag">‚è±Ô∏è Chaque seconde compte ‚Äî choisis. agis. sauve.</div>
          </div>

          <!-- ‚úÖ √âCRAN 2 : R√àGLES FULLSCREEN NOIR -->
          <div class="screen" id="screenRules">
            <div class="rulesFull">
              <div class="rulesContainer">

                <div class="gameTitleWrap">
                  <div class="titlePill">GUIDE ‚Ä¢ R√àGLES DU JEU</div>
                  <h1 class="gameTitle">URGENCES</h1>
                  <div class="gameSubtitle">AGIR POUR SAUVER</div>
                </div>

                <div class="rulesGlass">

                  <div class="rulesHeader">
                    <p class="helloRules" id="helloLineRules"></p>
                    <div class="stepPill">
                      <span class="stepDot"></span>
                      <span id="stepCounter">√âtape 1/5</span>
                    </div>
                  </div>

                  <div class="rulesBody">

                    <!-- STEP 1 -->
                    <div class="step active" data-step="1">
                      <div class="rulesGrid">
                        <div class="panel">
                          <div class="panelTitle">
                            <h3>üßë‚Äç‚öïÔ∏è 1) Choix du m√©tier</h3>
                            <span class="tag">Personnalisation</span>
                          </div>
                          <p class="ruleText">
                            Tu commences par choisir un m√©tier : <b>M√©decin</b>, <b>Pompier</b> ou <b>Infirmier</b>.
                            Ensuite, le parcours et les sc√©narios s‚Äôadaptent automatiquement √† ton r√¥le.
                          </p>
                          <ul class="bullets">
                            <li>Chaque m√©tier propose des situations coh√©rentes avec ses missions.</li>
                            <li>Ton choix est m√©moris√© pour la suite du jeu.</li>
                            <li>Tu peux recommencer plus tard avec un autre m√©tier.</li>
                          </ul>
                        </div>

                        <div class="panel">
                          <div class="visual">
                            <div class="bigStat">
                              <div class="statTop">
                                <p class="statLabel">R√àGLE CL√â</p>
                                <div class="chip"><span class="dot"></span> ADAPTATIF</div>
                              </div>
                              <p class="statValue">3</p>
                              <div class="statMeter"><span style="width:72%"></span></div>
                              <p class="statHint">3 m√©tiers au choix ‚Äî ton parcours se personnalise automatiquement.</p>
                            </div>

                            <div class="miniRow">
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üí°</span> Conseil</p>
                                <p class="miniText">Choisis le r√¥le qui te motive : tu seras plus rapide et plus s√ªr.</p>
                              </div>
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üíæ</span> Sauvegarde</p>
                                <p class="miniText">Ton m√©tier est m√©moris√© pour les √©tapes suivantes.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- STEP 2 -->
                    <div class="step" data-step="2">
                      <div class="rulesGrid">
                        <div class="panel">
                          <div class="panelTitle">
                            <h3>üéöÔ∏è 2) Choix du niveau</h3>
                            <span class="tag">Difficult√©</span>
                          </div>
                          <p class="ruleText">
                            Tu choisis ensuite un niveau : <b>D√©butant</b>, <b>Interm√©diaire</b> ou <b>Expert</b>.
                            La difficult√© (indices, rapidit√©, exigences) s‚Äôajuste √† ton choix.
                          </p>
                          <ul class="bullets">
                            <li><b>D√©butant</b> : guidage renforc√© et apprentissage progressif.</li>
                            <li><b>Interm√©diaire</b> : moins d‚Äôindices, plus d‚Äôautonomie.</li>
                            <li><b>Expert</b> : sc√©narios exigeants, temps de r√©action serr√©.</li>
                          </ul>
                        </div>

                        <div class="panel">
                          <div class="visual">
                            <div class="bigStat">
                              <div class="statTop">
                                <p class="statLabel">R√àGLE CL√â</p>
                                <div class="chip"><span class="dot"></span> NIVEAUX</div>
                              </div>
                              <p class="statValue">3</p>
                              <div class="statMeter"><span style="width:66%"></span></div>
                              <p class="statHint">Choisis ta difficult√© : D√©butant, Interm√©diaire ou Expert.</p>
                            </div>

                            <div class="miniRow">
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üéØ</span> Objectif</p>
                                <p class="miniText">Adapter le challenge √† ton rythme d‚Äôapprentissage.</p>
                              </div>
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">‚öôÔ∏è</span> Ajustement</p>
                                <p class="miniText">Indices, rythme et exigence changent selon le niveau.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- STEP 3 -->
                    <div class="step" data-step="3">
                      <div class="rulesGrid">
                        <div class="panel">
                          <div class="panelTitle">
                            <h3>üèÜ 3) Syst√®me de points</h3>
                            <span class="tag">Score</span>
                          </div>
                          <p class="ruleText">
                            √Ä chaque r√©ponse correcte, tu gagnes <b>10 points</b>.
                            Ton score refl√®te ta progression et encourage la r√©gularit√©.
                          </p>
                          <ul class="bullets">
                            <li>Bonne r√©ponse = <b>+10</b> points.</li>
                            <li>Le score peut servir √† d√©bloquer des √©tapes (selon ton sc√©nario Genially).</li>
                            <li>Reste concentr√© : chaque choix compte.</li>
                          </ul>
                        </div>

                        <div class="panel">
                          <div class="visual">
                            <div class="bigStat">
                              <div class="statTop">
                                <p class="statLabel">GAIN</p>
                                <div class="chip"><span class="dot"></span> POINTS</div>
                              </div>
                              <p class="statValue">+10</p>
                              <div class="statMeter"><span style="width:80%"></span></div>
                              <p class="statHint">Chaque bonne r√©ponse ajoute 10 points √† ton score.</p>
                            </div>

                            <div class="miniRow">
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üìà</span> Progression</p>
                                <p class="miniText">Plus tu r√©ussis, plus tu avances rapidement.</p>
                              </div>
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">‚è±Ô∏è</span> Focus</p>
                                <p class="miniText">La rapidit√© et la pr√©cision font la diff√©rence.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- STEP 4 -->
                    <div class="step" data-step="4">
                      <div class="rulesGrid">
                        <div class="panel">
                          <div class="panelTitle">
                            <h3>üîÅ 4) Tentatives et reprise</h3>
                            <span class="tag">Rigueur</span>
                          </div>
                          <p class="ruleText">
                            Si tu perds <b>2 tentatives</b>, tu dois reprendre les questions <b>depuis le d√©but</b>.
                            L‚Äôobjectif : renforcer la m√©morisation et la ma√Ætrise des gestes.
                          </p>
                          <ul class="bullets">
                            <li>2 erreurs = reprise du bloc de questions.</li>
                            <li>Reste attentif et relis les consignes.</li>
                            <li>Le jeu r√©compense la pers√©v√©rance.</li>
                          </ul>
                        </div>

                        <div class="panel">
                          <div class="visual">
                            <div class="bigStat">
                              <div class="statTop">
                                <p class="statLabel">LIMITE</p>
                                <div class="chip"><span class="dot"></span> TENTATIVES</div>
                              </div>
                              <p class="statValue">2</p>
                              <div class="statMeter"><span style="width:58%"></span></div>
                              <p class="statHint">Apr√®s 2 √©checs : retour au d√©but des questions.</p>
                            </div>

                            <div class="miniRow">
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üß†</span> M√©moire</p>
                                <p class="miniText">Recommencer aide √† consolider les bons r√©flexes.</p>
                              </div>
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üõ°Ô∏è</span> S√©curit√©</p>
                                <p class="miniText">En urgence, une erreur peut co√ªter cher : entra√Ænement obligatoire.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- STEP 5 -->
                    <div class="step" data-step="5">
                      <div class="rulesGrid">
                        <div class="panel">
                          <div class="panelTitle">
                            <h3>üéñÔ∏è 5) Badges de sc√©nario</h3>
                            <span class="tag">R√©compense</span>
                          </div>
                          <p class="ruleText">
                            Chaque sc√©nario termin√© te fait gagner un <b>badge</b>.
                            C‚Äôest une r√©compense visuelle qui valide tes acquis.
                          </p>
                          <ul class="bullets">
                            <li>1 sc√©nario termin√© = <b>1 badge</b>.</li>
                            <li>Les badges montrent ta progression dans la mission.</li>
                            <li>Objectif : collectionner tous les badges !</li>
                          </ul>
                        </div>

                        <div class="panel">
                          <div class="visual">
                            <div class="bigStat">
                              <div class="statTop">
                                <p class="statLabel">R√âCOMPENSE</p>
                                <div class="chip"><span class="dot"></span> BADGES</div>
                              </div>
                              <p class="statValue">üèÖ</p>
                              <div class="statMeter"><span style="width:74%"></span></div>
                              <p class="statHint">Terminer un sc√©nario d√©bloque un badge de progression.</p>
                            </div>

                            <div class="miniRow">
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">‚úÖ</span> Validation</p>
                                <p class="miniText">Chaque badge confirme que tu ma√Ætrises une comp√©tence.</p>
                              </div>
                              <div class="mini">
                                <p class="miniTitle"><span class="miniIcon">üèÅ</span> Objectif</p>
                                <p class="miniText">Obtenir tous les badges = mission compl√®te.</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- NAV (boutons seulement) -->
                    <div class="navBar">
                      <div class="dots" id="dots"></div>
                      <div class="btnRow">
                        <button class="btn-ghost" type="button" id="prevBtn">‚¨Ö Pr√©c√©dent</button>
                        <button class="btn-ember" type="button" id="nextRuleBtn">Suivant ‚ûú</button>
                      </div>
                    </div>

                    <!-- ‚úÖ Bouton mission en bas, d√©sactiv√© jusqu'√† l'√©tape 5 -->
                    <div class="missionBar">
                      <button class="btn-ember btnMission" type="button" id="startMissionBtn" disabled>
                        üöÄ Commencer la mission
                      </button>
                    </div>

                  </div>

                  <div class="footer" id="helpTxt">
                    Utilise ‚ÄúSuivant‚Äù pour lire les r√®gles, √©tape par √©tape.
                  </div>

                </div>

              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>

<script>
  /* ‚úÖ Scale auto pour tenir dans l‚Äôiframe Genially (1980x1020) */
  (function scaleGeniallyPage(){
    const page = document.getElementById('geniallyPage');
    const BASE_W = 1980, BASE_H = 1020;
    function apply(){
      const sw = window.innerWidth / BASE_W;
      const sh = window.innerHeight / BASE_H;
      page.style.transform = `scale(${Math.min(sw, sh)})`;
    }
    window.addEventListener('resize', apply);
    apply();
  })();

  /* ‚úÖ Nettoyage des variables "d'avant" quand l'utilisateur recommence le jeu */
  (function resetPreviousRun(){
    const KEEP_NAME = true; // garde le nom si d√©j√† existant
    const preservedName = localStorage.getItem("player_name");

    const keysToClear = [
      "role","avatar","niveau","score","points",
      "badges","attempts","tentatives","progress",
      "playerName"
    ];
    keysToClear.forEach(k => localStorage.removeItem(k));

    if (KEEP_NAME && preservedName) localStorage.setItem("player_name", preservedName);
    if (!KEEP_NAME) localStorage.removeItem("player_name");
  })();

  /* ‚úÖ SFX "approbation" uniquement (pas de son de passage) */
  let audioReady = false;
  let AC = null;

  function ensureAudio(){
    if (audioReady) return;
    AC = new (window.AudioContext || window.webkitAudioContext)();
    audioReady = true;
  }

  function playApprove(){
    ensureAudio();
    const t = AC.currentTime;

    function note(freq, start, dur){
      const o = AC.createOscillator();
      const g = AC.createGain();
      o.type = "triangle";
      o.frequency.setValueAtTime(freq, start);
      g.gain.setValueAtTime(0.0001, start);
      g.gain.exponentialRampToValueAtTime(0.12, start + 0.02);
      g.gain.exponentialRampToValueAtTime(0.0001, start + dur);
      o.connect(g); g.connect(AC.destination);
      o.start(start); o.stop(start + dur + 0.02);
    }
    note(523.25, t, 0.12);
    note(659.25, t+0.12, 0.12);
    note(783.99, t+0.24, 0.18);
  }

  /* ‚úÖ ACCUEIL */
  const screenHome = document.getElementById("screenHome");
  const screenRules = document.getElementById("screenRules");

  const playerNameInput = document.getElementById("playerName");
  const saveBtn = document.getElementById("saveBtn");
  const nextBtn = document.getElementById("nextBtn");
  const continueBtn = document.getElementById("continueBtn");

  const savedName = localStorage.getItem("player_name");
  if (savedName) {
    playerNameInput.value = savedName;
    nextBtn.disabled = false;
  }

  function pulse(el){
    el.classList.add("shake");
    setTimeout(()=>el.classList.remove("shake"), 250);
  }

  saveBtn.addEventListener("click", () => {
    const name = (playerNameInput.value || "").trim();
    if (!name) { playerNameInput.focus(); pulse(saveBtn); return; }
    localStorage.setItem("player_name", name);
    nextBtn.disabled = false;
    playApprove();          // ‚úÖ son approbation
    pulse(saveBtn);
  });

  nextBtn.addEventListener("click", () => {
    if (nextBtn.disabled) { pulse(nextBtn); return; }
    screenHome.classList.remove("active");
    screenRules.classList.add("active");
    initRules();
  });

  continueBtn.addEventListener("click", () => {
    // Rien ici volontairement
  });

  /* ‚úÖ R√àGLES */
  const helloLineRules = document.getElementById("helloLineRules");
  const steps = Array.from(document.querySelectorAll(".step"));
  const dotsWrap = document.getElementById("dots");
  const stepCounter = document.getElementById("stepCounter");
  const helpTxt = document.getElementById("helpTxt");

  const prevBtn = document.getElementById("prevBtn");
  const nextRuleBtn = document.getElementById("nextRuleBtn");
  const startMissionBtn = document.getElementById("startMissionBtn");

  let current = 0;
  let rulesInited = false;

  function initRules(){
    if (rulesInited) return;
    rulesInited = true;

    const pName = localStorage.getItem("player_name") || localStorage.getItem("playerName") || "Joueur";
    helloLineRules.innerHTML = `Bonjour <span class="name">${escapeHtml(pName)}</span>, d√©couvre les r√®gles du jeu.`;

    buildDots();
    goTo(0);
  }

  function buildDots(){
    dotsWrap.innerHTML = "";
    steps.forEach((_, i)=>{
      const d = document.createElement("button");
      d.type = "button";
      d.className = "dotBtn";
      d.setAttribute("aria-label", "√âtape " + (i+1));
      d.addEventListener("click", ()=>goTo(i));
      dotsWrap.appendChild(d);
    });
  }

  function goTo(i){
    current = Math.max(0, Math.min(steps.length-1, i));
    steps.forEach((s, idx)=>s.classList.toggle("active", idx === current));
    Array.from(dotsWrap.children).forEach((d, idx)=>d.classList.toggle("active", idx === current));

    stepCounter.textContent = `√âtape ${current+1}/${steps.length}`;

    prevBtn.disabled = current === 0;

    // ‚úÖ Toujours garder "Suivant" visible
    nextRuleBtn.disabled = current === steps.length-1;

    // ‚úÖ Le bouton "Commencer la mission" reste en bas, d√©sactiv√©,
    // et s'active uniquement √† la derni√®re √©tape
    const isLast = current === steps.length - 1;
    startMissionBtn.disabled = !isLast;

    const hints = [
      "Choisis ton m√©tier : le parcours s‚Äôadapte √† ton r√¥le.",
      "Choisis un niveau : la difficult√© s‚Äôajuste.",
      "Chaque bonne r√©ponse = +10 points.",
      "Apr√®s 2 tentatives perdues : reprise depuis le d√©but des questions.",
      "Tu as tout lu ! Tu peux maintenant lancer la mission."
    ];
    helpTxt.textContent = hints[current] || "Utilise ‚ÄúSuivant‚Äù pour continuer.";
  }

  prevBtn.addEventListener("click", ()=>{
    if (prevBtn.disabled) return pulse(prevBtn);
    goTo(current-1);
  });

  nextRuleBtn.addEventListener("click", ()=>{
    if (nextRuleBtn.disabled) return pulse(nextRuleBtn);
    goTo(current+1);
  });

  startMissionBtn.addEventListener("click", ()=>{
    if (startMissionBtn.disabled) return pulse(startMissionBtn);
    playApprove(); // ‚úÖ son approbation (garde celui-ci)
    pulse(startMissionBtn);
    helpTxt.textContent = "üöÄ Pr√™t ! Continue dans Genially.";
    // volontairement vide (pas de redirection)
  });

  window.addEventListener("keydown", (e)=>{
    if (!screenRules.classList.contains("active")) return;
    if (e.key === "ArrowLeft") goTo(current-1);
    if (e.key === "ArrowRight") goTo(current+1);
  });

  // ‚úÖ autoriser audio context sur 1er clic utilisateur
  window.addEventListener("pointerdown", ()=>{
    if (!audioReady) ensureAudio();
  }, { once:true });

  function escapeHtml(str){
    return String(str).replace(/[&<>"']/g,m=>({
      "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
    }[m]));
  }
</script>

</body>
</html>
